/*! For license information please see payment_mb.js.LICENSE.txt */
(()=>{function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}var t={ppp:null,config:null,paymentId:null,setConfig:function(e,t){this.config={approvalUrl:e.approvalUrlPPP,placeholder:t,mode:e.paypalMode,payerEmail:e.payerInfo.email,payerFirstName:e.payerInfo.first_name,payerLastName:e.payerInfo.last_name,payerTaxId:e.payerInfo.tax_id,payerTaxIdType:e.payerInfo.tax_id_type,language:e.language,country:e.country,disallowRememberedCards:e.disallowRememberedCards,rememberedCards:e.rememberedCards,onError:this.handleError,merchantInstallmentSelectionOptional:1==e.merchantInstallmentSelectionOptional,merchantInstallmentSelection:1},this.paymentId=e.paymentId},initCheckout:function(){var e=this;this.setLoader("#ppplus-mb"),this.getPaymentInfo().then((function(t){if(e.setConfig(t,"ppplus-mb"),"BR"!=e.config.country||""!=e.config.payerTaxId)e.ppp=PAYPAL.apps.PPP(e.config);else{var a="undefined"!=typeof EMPTY_TAX_ID?EMPTY_TAX_ID:"Payer tax id is empty";e.showMessage(a,"#ppplus-mb","danger")}})).catch((function(e){}))},showMessage:function(e,t,a){var n=$('<div class="alert alert-'.concat(a,'" />'));n.text(e),$(t).html(n)},setLoader:function(e){$(e).html('<div class="pp__flex pp__justify-content-center"><div class="paypal-loader"></div></div>')},doPayment:function(){null!=this.ppp&&this.ppp.doContinue()},getPaymentInfo:function(){return new Promise((function(e,t){$.ajax({url:ajaxPatch,type:"POST",dataType:"JSON",data:{ajax:!0,action:"getPaymentInfo"},before:function(){},success:function(t){"success"in t&&1==t.success&&e(t.paymentInfo)}})}))},messageListener:function(e){try{var a=JSON.parse(e.data);"checkout"==a.action&&"APPROVED"==a.result.state&&(a.paymentId=t.paymentId,t.sendData(a,ajaxPatch))}catch(e){}},handleError:function(t){if(void 0!==t.cause){var a=t.cause.replace(/['"]+/g,"");switch(a){case"INTERNAL_SERVICE_ERROR":case"SOCKET_HANG_UP":case"socket hang up":case"connect ECONNREFUSED":case"connect ETIMEDOUT":case"UNKNOWN_INTERNAL_ERROR":case"fiWalletLifecycle_unknown_error":case"Failed to decrypt term info":case"RESOURCE_NOT_FOUND":case"INTERNAL_SERVER_ERROR":case"CARD_ATTEMPT_INVALID":default:alert("Ocorreu um erro inesperado, por favor tente novamente. ("+a+")");break;case"RISK_N_DECLINE":case"NO_VALID_FUNDING_SOURCE_OR_RISK_REFUSED":case"TRY_ANOTHER_CARD":case"NO_VALID_FUNDING_INSTRUMENT":alert("Seu pagamento não foi aprovado. Por favor utilize outro cartão, caso o problema persista entre em contato com o PayPal (0800-047-4482). ("+a+")");break;case"INVALID_OR_EXPIRED_TOKEN":alert("A sua sessão expirou, por favor tente novamente. ("+a+")");break;case"CHECK_ENTRY":alert("Por favor revise os dados de Cartão de Crédito inseridos. ("+a+")")}}e(t)},sendData:function(e,a){var n;n="undefined"!=typeof PAYMENT_SUCCESS?PAYMENT_SUCCESS:"Payment successful! You will be redirected to the payment confirmation page in a couple of seconds.",t.showMessage(n,"#ppplus-mb","success"),$("#ppplus-mb").css("height","100%");var o=document.createElement("form"),r=document.createElement("input");r.name="paymentData",r.value=JSON.stringify(e),o.method="POST",o.action=a,o.appendChild(r),o.style="display: none",document.body.appendChild(o),o.submit()}};$(document).ready((function(){if("paypal_plus_mb"==$('.payment-options input[name="payment-option"]:checked').attr("data-module-name")&&t.initCheckout(),$('.payment-options input[name="payment-option"]').click((function(e){"paypal_plus_mb"==$(e.target).attr("data-module-name")&&t.initCheckout()})),prestashop.on("updatedCart",(function(){t.initCheckout()})),$("#payment-confirmation button").on("click",(function(e){"paypal_plus_mb"==$("input[name=payment-option]:checked").attr("data-module-name")&&(e.preventDefault(),e.stopPropagation(),t.doPayment())})),window.addEventListener)window.addEventListener("message",t.messageListener,!1);else{if(!window.attachEvent)throw new Error("Can't attach message listener");window.attachEvent("onmessage",t.messageListener)}}))})();
//# sourceMappingURL=payment_mb.js.map